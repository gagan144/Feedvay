

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Models &mdash; feedvay 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="feedvay 1.0 documentation" href="../../index.html"/>
        <link rel="up" title="Accounts" href="index.html"/>
        <link rel="next" title="Forms" href="forms.html"/>
        <link rel="prev" title="Password Recovery" href="mod_password_recovery.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> feedvay
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../main/index.html">Main App</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Accounts</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#modules">Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#contents">Contents</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="forms.html">Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Watchdog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../owlery/index.html">Owlery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../management_commands/index.html">Management Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console/index.html">Console</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">feedvay</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Accounts</a> &raquo;</li>
      
    <li>Models</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/accounts/models.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h1>
<p>List of database models (MySQL &amp; MongoDb) for accounts app.</p>
<span class="target" id="module-accounts.models"></span><dl class="class">
<dt id="accounts.models.RegisteredUser">
<em class="property">class </em><code class="descclassname">accounts.models.</code><code class="descname">RegisteredUser</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension of django <code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.User</span></code> model that maintains all public user
information. For every public user, a record is created with reference to &#8216;User&#8217; model along with
other attributes such as mode of registration, user personal settings etc.</p>
<p><strong>Points</strong>:</p>
<blockquote>
<div><ul>
<li><p class="first">This model does not include any staff users.</p>
</li>
<li><p class="first">Username of these users is the mobile phone no with country code as prefix. Example: +919999999999</p>
</li>
<li><p class="first">All login related process such as session allocation etc are done using traditional django &#8216;User&#8217; model whereas
other business related functionality are done using this model.</p>
</li>
<li><p class="first">Detailed personal information are not kept in this model. It only contains basic information only such as name, email id.</p>
</li>
<li><p class="first">Registration methods:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Website</strong> (Only one time): User can register directly on website using mobile no.</li>
<li><strong>Mobile app</strong> (Multiple times): User can register using mobile app.</li>
<li><strong>Enterprise app</strong> (Only one time): Passive registration of the user that is automatically created as a <strong>lead</strong> while using enterprise app.
The account remains inactive until user register himself manually using any of the methods. Only one time record is created
and ignore in further cases.</li>
</ul>
<p>For registration flow, refer the document.</p>
</div></blockquote>
</li>
<li><p class="first">Registration can be multiple times. Only last registration information is kept for now.</p>
</li>
</ul>
</div></blockquote>
<p><strong>State chart diagram for state machine</strong>:</p>
<blockquote>
<div><img alt="../../_images/registereduser_statechart.jpg" src="../../_images/registereduser_statechart.jpg" />
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This model must not trigger any update to django &#8216;User&#8217; model since it can trigger model&#8217;s save.
However, you can update this model without any intervention of &#8216;User&#8217; model.</p>
</div>
<p><strong>Authors</strong>: Gagandeep Singh</p>
<dl class="method">
<dt id="accounts.models.RegisteredUser.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to clean &amp; validate data fields.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="staticmethod">
<dt id="accounts.models.RegisteredUser.construct_username">
<em class="property">static </em><code class="descname">construct_username</code><span class="sig-paren">(</span><em>country_tel_code</em>, <em>mobile_no</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.construct_username"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.construct_username" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method to create actual database username by concatenating
country telephone code and 10-digit mobile number</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>country_tel_code</strong> &#8211; Country telephone code</li>
<li><strong>mobile_no</strong> &#8211; 10-digit mobile number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Actual username; &#8216;&lt;country_tel_code&gt;+&lt;mobile_no&gt;&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="classmethod">
<dt id="accounts.models.RegisteredUser.post_save">
<em class="property">classmethod </em><code class="descname">post_save</code><span class="sig-paren">(</span><em>sender</em>, <em>instance</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.post_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.post_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Post save trigger for this model. This will be called after the record has
been created or updated.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.RegisteredUser.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-save method for this model.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.RegisteredUser.set_password">
<code class="descname">set_password</code><span class="sig-paren">(</span><em>new_password</em>, <em>send_owls=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.set_password"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.set_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to set a registered user password and save it.
This also sends any owls (Email or SMS) if required. Any owls related errors are silently ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_password</strong> &#8211; New password</li>
<li><strong>send_owls</strong> &#8211; Set True to send mail/SMS to the user. Default:True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To prevent logout, execute following after this function.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">auth</span><span class="o">.</span><span class="n">update_session_auth_hash</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method does not confirm with old password. Please confirm old password
before changing as per your use case for security reasons.</p>
</div>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.RegisteredUser.trans_registered">
<code class="descname">trans_registered</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.trans_registered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.trans_registered" title="Permalink to this definition">¶</a></dt>
<dd><p>User has registered. Status is transitioned from <code class="docutils literal"><span class="pre">lead</span></code> to <code class="docutils literal"><span class="pre">verification_pending</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.RegisteredUser.trans_verification_completed">
<code class="descname">trans_verification_completed</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#RegisteredUser.trans_verification_completed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.RegisteredUser.trans_verification_completed" title="Permalink to this definition">¶</a></dt>
<dd><p>User has verified himself. Status is transitioned from <code class="docutils literal"><span class="pre">verification_pending</span></code> to <code class="docutils literal"><span class="pre">verified</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="accounts.models.UserProfile">
<em class="property">class </em><code class="descclassname">accounts.models.</code><code class="descname">UserProfile</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Mongodb model to store registered user information. This model includes wide variety
of user related attributes.</p>
<p><strong>Attribute organisation</strong>:
User attributes and their values are organised in two ways; dictionary and list. This is done
to provide query optimization for wide use cases.</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first"><strong>Dictionary</strong>: Attributes are maintained as key-value pair in a dictionary field <strong>&#8216;attributes&#8217;</strong>.
Use this field for quick value lookup mostly when attribute name is known. Also in case of
report display, use this field to get attribute values.</p>
<blockquote>
<div><ul class="simple">
<li>Contains only currently active attributes for the user.</li>
<li>Read-only field. Do not write/delete inside this field. It is overridden by save().</li>
<li>This field is <strong>not indexed</strong>, since dictionary indexing does not perform well.</li>
<li>So, <strong>NEVER</strong> use this field for complex query, aggregations or map-reduce.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>List of objects</strong>: Attributes are also maintained in form of list of objects in the field <strong>&#8216;list_attributes&#8217;</strong>,
with each object in the list representing one attribute having information such as name, value as well as
other meta information such as active, last updated on etc.</p>
<blockquote>
<div><ul class="simple">
<li>Contains all active &amp; inactive fields.</li>
<li>Save uses this field to populate <strong>&#8216;attributes&#8217;</strong> field.</li>
<li>This field is <strong>indexed</strong> on name, value &amp; active field of the objects across all documents in UserProfile.</li>
<li>Always use this field for complex queries and aggregation.</li>
<li>While using <strong>MongoDb aggregation framework</strong>, unwind <strong>list_attributes</strong> before aggregating.</li>
<li><strong>Map-Reduce</strong> might not take good advantage of this field since unwind is not available for MongoDb M-R.</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p><strong>Adding/updating new attribute</strong>:</p>
<blockquote>
<div><p>Always add or update attribute using <strong>&#8216;list_attributes&#8217;</strong> field only. <strong>DO NOT</strong> use &#8216;attributes&#8217; field.
This is because save function will truncate &#8216;attributes&#8217; field, loop over &#8216;list_attributes&#8217; and add only active
attributes to &#8216;attributes&#8217; field.</p>
<p>Use of <code class="docutils literal"><span class="pre">add_update_attribute()</span></code> is recommended.</p>
</div></blockquote>
<p><strong>Deleting attribute</strong>:</p>
<blockquote>
<div><p>Always use &#8216;list_attributes&#8217; field but <strong>NEVER</strong> delete any entry. TO delete an attribute, mark that attribute
as <code class="docutils literal"><span class="pre">active=False</span></code>. Save function will automatically remove it from &#8216;attributes&#8217; field.
To revive an attribute, override its value and mark <code class="docutils literal"><span class="pre">active=True</span></code>.</p>
<p>Use of <code class="docutils literal"><span class="pre">delete_attribute()</span></code> is recommended.</p>
</div></blockquote>
<p><strong>Mandatory attributes</strong>:</p>
<blockquote>
<div>All attributes in <strong>UserAttributes</strong> embedded document tagged as <code class="docutils literal"><span class="pre">required=True</span></code> are mandatory and must be
present in &#8216;list_attributes&#8217;. Model will not save until all required fields have values.</div></blockquote>
<p><strong>When this model is created/updated</strong>:</p>
<blockquote>
<div>This model is created only during registration process and updated each time <a class="reference internal" href="#accounts.models.RegisteredUser" title="accounts.models.RegisteredUser"><code class="xref py py-class docutils literal"><span class="pre">accounts.models.RegisteredUser</span></code></a> is saved.</div></blockquote>
<p><strong>Authors</strong>: Gagandeep Singh</p>
<dl class="class">
<dt id="accounts.models.UserProfile.DetailedAttribute">
<em class="property">class </em><code class="descname">DetailedAttribute</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.DetailedAttribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.DetailedAttribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Mongodb embedded document to store an attribute in detail. This not only includes attribute name and value,
but also other meta information such as active, last_updated_on etc.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not delete this record. Simply mark active as false.</p>
</div>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="class">
<dt id="accounts.models.UserProfile.UserAttributes">
<em class="property">class </em><code class="descclassname">UserProfile.</code><code class="descname">UserAttributes</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.UserAttributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.UserAttributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Mongodb embedded document for <a class="reference internal" href="#accounts.models.UserProfile" title="accounts.models.UserProfile"><code class="xref py py-class docutils literal"><span class="pre">accounts.models.UserProfile</span></code></a> model.
It is this document that stores user attributes in key-value pairs.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use this model for quick lookup for attribute value. These keys will not be indexed
so <strong>DO NOT</strong> use them in queries.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<dl class="last docutils">
<dt>Following attributes will be replaced by that in <code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.User</span></code> model:</dt>
<dd><ul class="first last simple">
<li>first_name</li>
<li>last_name</li>
</ul>
</dd>
</dl>
</div>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserProfile.add_update_attribute">
<code class="descclassname">UserProfile.</code><code class="descname">add_update_attribute</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>auto_save=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.add_update_attribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.add_update_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to add new attribute if it does not exists or update an attribute if it is not locked.
An attribute will automatically be revived if found inactive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; Name of the attribute.</li>
<li><strong>value</strong> &#8211; Value for that attribute.</li>
<li><strong>auto_save</strong> &#8211; True to write to db after addition else False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Bool tuple (is_new, updated) &#8216;is_new&#8217;: True if attribute was created. &#8216;updated&#8217;: True if action was success else False</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: Throws &#8216;ValidationError&#8217; if attribute is locked</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserProfile.delete_attribute">
<code class="descclassname">UserProfile.</code><code class="descname">delete_attribute</code><span class="sig-paren">(</span><em>name</em>, <em>auto_save=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.delete_attribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.delete_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete an attribute, that is mark attribute active as false.
An already deleted (inactive) attribute will again be marked inactive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; Name of the attribute</li>
<li><strong>auto_save</strong> &#8211; True to write to db after deletion else False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Bool tuple (found, updated)</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: Throws &#8216;ValidationError&#8217; if attribute is locked</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserProfile.lock_attribute">
<code class="descclassname">UserProfile.</code><code class="descname">lock_attribute</code><span class="sig-paren">(</span><em>name</em>, <em>auto_save=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.lock_attribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.lock_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to lock an attribute. Locking an attribute will prevent any updation or deletion of an attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; Name of the attribute.</li>
<li><strong>auto_save</strong> &#8211; Save model after locking</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if attribute found and successfully locked else False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserProfile.save">
<code class="descclassname">UserProfile.</code><code class="descname">save</code><span class="sig-paren">(</span><em>complete_save=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-save method for this model.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserProfile.unlock_attribute">
<code class="descclassname">UserProfile.</code><code class="descname">unlock_attribute</code><span class="sig-paren">(</span><em>name</em>, <em>auto_save=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserProfile.unlock_attribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserProfile.unlock_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to unlock an attribute and release it from locked state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; Name of the attribute</li>
<li><strong>auto_save</strong> &#8211; Save model after unlocking</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if attribute found and successfully released else False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="accounts.models.UserSession">
<em class="property">class </em><code class="descclassname">accounts.models.</code><code class="descname">UserSession</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserSession"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserSession" title="Permalink to this definition">¶</a></dt>
<dd><p>Model to link user to its session. Currently, django does not provide direct linking of
user to its sessions. On login, a session is created and send session_id to the browser
in the cookie, which is received back in the request from where server resolve session.
So, there is no way to find all sessions of a user.</p>
<p>This model keeps a track of session and its user. Whenever a user logs in, django fires
a &#8216;logged in&#8217; signal which is captured and an entry is made with user and session key.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="class">
<dt id="accounts.models.UserToken">
<em class="property">class </em><code class="descclassname">accounts.models.</code><code class="descname">UserToken</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserToken"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserToken" title="Permalink to this definition">¶</a></dt>
<dd><p>Model to store tokens issued to a registered user for various purposes such as registration.</p>
<p><strong>Points</strong>:</p>
<blockquote>
<div><ul class="simple">
<li>Uniqueness of a token is based on <code class="xref py py-class docutils literal"><span class="pre">accounts.model.RegisteredUser</span></code> and purpose.</li>
<li>Tokens are only issued to registered user.</li>
<li>Token can be overridden for same user &amp; purpose. This is possible when the same process is again executed.</li>
<li>No audit trail is maintained for a token. Present is the only truth.</li>
<li>Token must be deleted after use or will be automatically deleted after they cross their expiry date.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tokens are not user sessions.</p>
</div>
<p><strong>Authors</strong>: Gagandeep Singh</p>
<dl class="method">
<dt id="accounts.models.UserToken.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserToken.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserToken.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to clean &amp; validate data fields.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="method">
<dt id="accounts.models.UserToken.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserToken.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserToken.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-save method for this model.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="staticmethod">
<dt id="accounts.models.UserToken.verify_user_token">
<em class="property">static </em><code class="descname">verify_user_token</code><span class="sig-paren">(</span><em>username</em>, <em>purpose</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#UserToken.verify_user_token"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.UserToken.verify_user_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method to verify token given a username and value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>username</strong> &#8211; Actual username</li>
<li><strong>purpose</strong> &#8211; Purpose of the token. One of the <code class="docutils literal"><span class="pre">UserToken.CH_PURPOSE</span></code></li>
<li><strong>value</strong> &#8211; Value of the token</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True (for pass) and False (if failed)</p>
</td>
</tr>
</tbody>
</table>
<p>Raises <a class="reference internal" href="exceptions.html#accounts.exceptions.InvalidRegisteredUser" title="accounts.exceptions.InvalidRegisteredUser"><code class="xref py py-class docutils literal"><span class="pre">accounts.exceptions.InvalidRegisteredUser</span></code></a> Exception incase registered user not found.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="accounts.models.force_logout_user">
<code class="descclassname">accounts.models.</code><code class="descname">force_logout_user</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#force_logout_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.force_logout_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to forcefully logout a user from all web login only.
Technically, this method finds all session references of a user from <a class="reference internal" href="#accounts.models.UserSession" title="accounts.models.UserSession"><code class="xref py py-class docutils literal"><span class="pre">accounts.models.UserSession</span></code></a>.
and delete them from SessionStore one-by-one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>user_id</strong> &#8211; User object id</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Number of deleted sessions from SessionStore</td>
</tr>
</tbody>
</table>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="function">
<dt id="accounts.models.user_logged_in_handler">
<code class="descclassname">accounts.models.</code><code class="descname">user_logged_in_handler</code><span class="sig-paren">(</span><em>sender</em>, <em>request</em>, <em>user</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#user_logged_in_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.user_logged_in_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>User login signal handler that creates an entry in <code class="xref py py-class docutils literal"><span class="pre">accounts.model.UserSession</span></code> to
map the session to current user.</p>
<p>Here session has already been created, hence it can be easily accessed from <code class="docutils literal"><span class="pre">request.session</span></code>.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

<dl class="function">
<dt id="accounts.models.user_logged_out_handler">
<code class="descclassname">accounts.models.</code><code class="descname">user_logged_out_handler</code><span class="sig-paren">(</span><em>sender</em>, <em>request</em>, <em>user</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/accounts/models.html#user_logged_out_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#accounts.models.user_logged_out_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>User logout signal handler that deletes user-session entry from <code class="xref py py-class docutils literal"><span class="pre">accounts.model.UserSession</span></code>.</p>
<p><strong>Authors</strong>: Gagandeep Singh</p>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="forms.html" class="btn btn-neutral float-right" title="Forms" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mod_password_recovery.html" class="btn btn-neutral" title="Password Recovery" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Gagandeep Singh.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>